geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash")
us.sports.revenue.sql <- "SELECT date_trunc('week', cd.calendar_dt) wk,
count(DISTINCT cd.account_id) actives,
sum(cd.volume) turnover,
sum(cd.gross_revenue) gross_revenue
FROM dw.contribution_daily cd
WHERE cd.sport_name LIKE '%US Sports%'
AND cd.calendar_dt BETWEEN to_date('2013-10-07', 'YYYY-MM-DD')
AND to_date('2016-11-27', 'YYYY-MM-DD')
GROUP BY date_trunc('week', cd.calendar_dt)
ORDER BY 1"
us.sports.revenue <- dbGetQuery(redshift.con,
us.sports.revenue.sql) %>%
mutate(wk = ymd(wk))
us.sports.revenue.comp <- us.sports.revenue %>%
mutate(wk = wk + days(364)) %>%
rename(actives_prev_yr = actives,
turnover_prev_yr = turnover,
gross_revenue_prev_yr = gross_revenue)
us.sports.revenue.yoy <- us.sports.revenue %>%
inner_join(us.sports.revenue.comp, by = "wk") %>%
mutate(actives_yoy = round(((actives - actives_prev_yr)/actives_prev_yr)* 100,2),
turnover_yoy = round(((turnover - turnover_prev_yr)/turnover_prev_yr)* 100,2),
gross_revenue_yoy = round(((gross_revenue - gross_revenue_prev_yr)/gross_revenue_prev_yr)* 100,2)) %>%
select(-actives, -actives_prev_yr, -turnover, -turnover_prev_yr, -gross_revenue, -gross_revenue_prev_yr)
ggplot(us.sports.revenue,
aes(x = wk,
y = gross_revenue)) +
geom_line() +
theme_minimal() +
labs(x = "Month",
y = "Gross Revenue (in AUD)",
title = "US Sports Revenue",
subtitle = "Basketball and American Football contribute to majority of revenue",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2013-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted")
ggplot(us.sports.revenue.yoy,
aes(x = wk,
y = gross_revenue_yoy)) +
geom_line() +
theme_minimal() +
labs(x = "Month",
y = "Gross Revenue YoY %",
title = "US Sports Revenue YoY",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash")
ggplot(us.sports.revenue,
aes(x = wk,
y = actives)) +
geom_line() +
theme_minimal() +
labs(x = "Month",
y = "Actives",
title = "US Sports Actives",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2013-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted")
ggplot(us.sports.revenue.yoy,
aes(x = wk,
y = actives_yoy)) +
geom_line() +
theme_minimal() +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash")
ggplot(us.sports.revenue,
aes(x = wk,
y = turnover)) +
geom_line() +
theme_minimal() +
labs(x = "Month",
y = "Turnover (in AUD)",
title = "US Sports Turnover",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2013-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted")
ggplot(us.sports.revenue.yoy,
aes(x = wk,
y = turnover_yoy)) +
geom_line() +
theme_minimal() +
labs(x = "Month",
y = "Turnover YoY %",
title = "US Sports Turnover YoY",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash")
us.sports.aus.sql <- "SELECT date_trunc('week', sd.calendar_dt) AS mth,
decode(sport_id, 6423, 'American Football', 7511, 'Baseball', 7522, 'Basketball', 7524, 'Ice Hockey', 'Other') AS sport_name,
count(DISTINCT sd.account_id) actives,
sum(sd.vol_gbp) turnover,
sum(sd.winnings_gbp) winnings
FROM dw.sd_actives sd
INNER JOIN dw.w_account_info wai
ON sd.account_id = wai.account_id
WHERE sd.calendar_dt between to_date('2013-10-07', 'YYYY-MM-DD') AND to_date('2016-11-27', 'YYYY-MM-DD')
AND sd.sport_id IN (6423, 7511, 7522, 7524)
AND wai.country_of_registration_id in (4,45)
GROUP BY date_trunc('week', sd.calendar_dt),
decode(sport_id, 6423, 'American Football', 7511, 'Baseball', 7522, 'Basketball', 7524, 'Ice Hockey', 'Other')
ORDER BY 1,2"
us.sports.aus <- dbGetQuery(redshift.con,
us.sports.aus.sql) %>%
mutate(mth = ymd(mth))
us.sports.aus.comp <- us.sports.aus %>%
mutate(mth = mth + days(364)) %>%
rename(actives_prev_yr = actives,
turnover_prev_yr = turnover,
winnings_prev_yr = winnings_revenue)
us.sports.aus.comp <- us.sports.aus %>%
mutate(mth = mth + days(364)) %>%
rename(actives_prev_yr = actives,
turnover_prev_yr = turnover,
winnings_prev_yr = winnings)
us.sports.aus.yoy <- us.sports.aus %>%
inner_join(us.sports.aus.comp, by = c("mth" = "mth", "sport_name" = "sport_name") %>%
mutate(actives_yoy = round(((actives - actives_prev_yr)/actives_prev_yr)* 100,2),
turnover_yoy = round(((turnover - turnover_prev_yr)/turnover_prev_yr)* 100,2),
winnings_yoy = round(((winnings - winnings_prev_yr)/winnings_prev_yr)* 100,2)) %>%
select(-actives, -actives_prev_yr, -turnover, -turnover_prev_yr, -winnings_revenue, -winnings_prev_yr)
)
us.sports.aus.yoy <- us.sports.aus %>%
inner_join(us.sports.aus.comp, by = c("mth" = "mth", "sport_name" = "sport_name")) %>%
mutate(actives_yoy = round(((actives - actives_prev_yr)/actives_prev_yr)* 100,2),
turnover_yoy = round(((turnover - turnover_prev_yr)/turnover_prev_yr)* 100,2),
winnings_yoy = round(((winnings - winnings_prev_yr)/winnings_prev_yr)* 100,2)) %>%
select(-actives, -actives_prev_yr, -turnover, -turnover_prev_yr, -winnings_revenue, -winnings_prev_yr)
us.sports.aus.yoy <- us.sports.aus %>%
inner_join(us.sports.aus.comp, by = c("mth" = "mth", "sport_name" = "sport_name")) %>%
mutate(actives_yoy = round(((actives - actives_prev_yr)/actives_prev_yr)* 100,2),
turnover_yoy = round(((turnover - turnover_prev_yr)/turnover_prev_yr)* 100,2),
winnings_yoy = round(((winnings - winnings_prev_yr)/winnings_prev_yr)* 100,2)) %>%
select(-actives, -actives_prev_yr, -turnover, -turnover_prev_yr, -winnings, -winnings_prev_yr)
View(us.sports.aus.yoy)
ggplot(us.sports.aus,
aes(x = mth,
y = actives,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.8) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives",
title = "US Sports Actives by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2013-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2014-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
theme(legend.position = "bottom")
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.8) +
theme_minimal() +
scale_colour_futurama(name = "Sport")
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash")
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.8) +
theme_minimal() +
scale_colour_futurama(name = "Sport")
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season")  +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash")
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.8) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
theme(legend.position = "bottom")
View(us.sports.aus.yoy)
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.8) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
View(us.sports.aus.yoy)
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line() +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.5) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.65) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.7) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.8) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
ggplot(us.sports.aus.yoy,
aes(x = mth,
y = actives_yoy,
group = sport_name,
colour = sport_name)) +
geom_line(size = 0.75) +
theme_minimal() +
scale_colour_futurama(name = "Sport") +
labs(x = "Month",
y = "Actives YoY %",
title = "US Sports Actives YoY by Sport",
caption = "Dashed Line is start of NBA Season, Dotted line is start of NFL Season") +
geom_vline(xintercept = as.numeric(ymd("2014-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2016-10-30")),
linetype = "dashed") +
geom_vline(xintercept = as.numeric(ymd("2015-09-07")),
linetype = "dotted") +
geom_vline(xintercept = as.numeric(ymd("2016-09-07")),
linetype = "dotted") +
geom_hline(yintercept = 0,
linetype = "dotdash") +
theme(legend.position = "bottom") +
coord_cartesian(ylim = c(-100,100))
?t.test
library(ggplot2)
?discrete_scale
?match.arg
?manual_pal
library(ggsci)
?scale_color_uchicago
?ggsci
?`ggsci-package`
?vector
ggsci_db2 = vector('list')
ggsci_db2$'npg'$'nrc' =
c('Cinnabar'     = '#E64B35', 'Shakespeare'    = '#4DBBD5',
'PersianGreen' = '#00A087', 'Chambray'       = '#3C5488',
'Apricot'      = '#F39B7F', 'WildBlueYonder' = '#8491B4',
'MonteCarlo'   = '#91D1C2', 'Monza'          = '#DC0000',
'RomanCoffee'  = '#7E6148', 'Sandrift'       = '#B09C85')
ggsci_db2
rm(list = ls())
x<-sample(1000)
?devtools::use_data
setwd("C:/Workspace/VSP/")
